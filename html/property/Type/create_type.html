{% extends 'layouts/master.html' %}
{% load static %}

{% block title %}
Address PMS | Create Property Type
{% endblock title %}



{% block content %}
<div class="row">
    <div class="col-md-6">
        <form class="card mb-3" method="post" enctype="multipart/form-data">
            <div class="card-header">
                <div class="row flex-between-end">
                    <div class="col-auto align-self-center">
                        <h5 class="mb-0" data-anchor="data-anchor">
                            <i class="fa-solid fa-city me-2"></i>
                            Create Property Type
                        </h5>
                    </div>
                </div>
            </div>

            <div class="card-body bg-light">
                {% csrf_token %}
                <div class="form-group row mb-2">
                    <label class="col-md-3 col-form-label" for="type">Type</label>
                    <div class="col-md-9">
                        {{form.type}}
                    </div>
                </div>
            </div>
  

            <div class="form-group row">
                <div class="col-md-9 offset-md-3 card-footer">
                    <button type="submit" class="btn btn-primary ms-2 me-3">
                        <i class="fa fa-save me-2"></i>
                        Create
                    </button>

                    <a href="{% url 'property:property-type' %}" class="btn btn-secondary">
                        <i class="fa fa-times me-2"></i>
                        Cancel
                    </a>
                </div>
            </div>
        </form>
    </div>
</div>


<!-- <script src="https://code.jquery.com/jquery-3.7.1.js"
        integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4=" crossorigin="anonymous"></script>


<script>
$(document).ready(function() {
    let counter = 0;

    $("#add_sup_type").click(function(e) {
        e.preventDefault();

        counter++;

        const sub_type_field = `
        <div class="show_item">
            <div class="row">
                <div class="col-md-8">
                    <label class="form-label" for="p_sub_type_title">Property Sub Type</label>
                    <div class="input-group">
                        <input type="text" class="form-control mx-2" id="p_sub_type_title" name="p_sub_type_title[]" placeholder="Enter property type">
                        <button class="btn btn-danger btn-sm ms-2 remove_btn" data-counter="${counter}">
                            Remove
                        </button>
                    </div>
                </div>
            </div>
        </div>
        `;

        $("#show_item").prepend(sub_type_field);
    });

    // Remove the sub type field
    $("#show_item").on("click", ".remove_btn", function() {
        $(this).closest(".show_item").remove();
    });

    

    // After Form submition data is pass view class by Ajax request
    $("#submit_button").click(function(e) {
        e.preventDefault();


        const Property_Type_Data = {
            "property_type_title": $("#p_type_title").val(),
        };

        const Property_Sub_Type_Data = [];
        $("input[name='p_sub_type_title[]']").each(function(index) {
            const sub_type = $(this).val();

            Property_Sub_Type_Data.push({
                "sub_type_data": sub_type,
            });
        });




        const formData = {
            "Type_Data": Property_Type_Data,
            "Sub_Type_Data": Property_Sub_Type_Data
        };

        const csrfToken = document.querySelector('[name=csrfmiddlewaretoken]').value;


        // Send data to the Django view using AJAX
        $.ajax({
            type: "POST",
            url: "{% url 'property:property-type-create' %}",
            data: JSON.stringify(formData),
            headers: {
                'Content-Type': 'application/json', 
                'X-CSRFToken': csrfToken
            },

            success: function(response) {
                // console.log("Success:", response);
                alert('Propety Type save successfully.');
                window.location.href = "{% url 'property:property-type' %}";
            },


            error: function(error) {
                // console.error("Error:", error);
                alert("Error is occard. Please try again !");
            }
        });
        
    });
});
</script> -->


{% endblock content %}